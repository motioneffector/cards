<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Types &amp; Interfaces - @motioneffector/cards</title>
  <link rel="stylesheet" href="../demo-files/demo.css">
  <link rel="stylesheet" href="manual.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>document.addEventListener('DOMContentLoaded', () => hljs.highlightAll());</script>
</head>
<body>
  <div class="page">
    <header class="header">
      <h1 class="header-title">@motioneffector/cards</h1>
      <p class="header-description">Documentation</p>
      <nav class="header-links">
        <a href="../index.html" class="header-link">Demo</a>
        <a href="https://www.npmjs.com/package/@motioneffector/cards" class="header-link">npm</a>
        <a href="https://github.com/motioneffector/cards" class="header-link">GitHub</a>
      </nav>
    </header>

    <div class="manual-layout">
      <aside class="manual-sidebar">
        <nav class="sidebar-nav">
<p><strong><a href="index.html">@motioneffector/cards</a></strong></p>
<p><strong>Getting Started</strong></p>
<ul>
<li><a href="installation.html">Installation</a></li>
<li><a href="your-first-character-card.html">Your First Character Card</a></li>
</ul>
<p><strong>Core Concepts</strong></p>
<ul>
<li><a href="concept-character-cards.html">Character Cards</a></li>
<li><a href="concept-lorebooks-and-decorators.html">Lorebooks &amp; Decorators</a></li>
<li><a href="concept-file-formats.html">File Formats</a></li>
<li><a href="concept-validation-and-repair.html">Validation &amp; Repair</a></li>
</ul>
<p><strong>Guides</strong></p>
<ul>
<li><a href="guide-reading-cards.html">Reading Cards</a></li>
<li><a href="guide-writing-and-exporting.html">Writing &amp; Exporting</a></li>
<li><a href="guide-working-with-decorators.html">Working with Decorators</a></li>
<li><a href="guide-validation-and-repair.html">Validation &amp; Repair</a></li>
<li><a href="guide-format-compatibility.html">Format Compatibility</a></li>
<li><a href="guide-bundling-assets-in-charx.html">Bundling Assets in CHARX</a></li>
</ul>
<p><strong>API Reference</strong></p>
<ul>
<li><a href="api-reading.html">Reading API</a></li>
<li><a href="api-writing.html">Writing API</a></li>
<li><a href="api-validation-and-repair.html">Validation &amp; Repair API</a></li>
<li><a href="api-decorator.html">Decorator API</a></li>
<li><a href="api-utilities.html">Utilities API</a></li>
<li><a href="api-types-and-interfaces.html">Types &amp; Interfaces</a></li>
<li><a href="api-error-classes.html">Error Classes</a></li>
</ul>

        </nav>
      </aside>

      <main class="manual-content">
        <article class="manual-article">
<h1>Types &amp; Interfaces</h1>
<p>Type definitions for all data structures used by the library.</p>
<hr>
<h2>CharacterCard</h2>
<p>The top-level V3 character card structure.</p>
<pre><code class="language-typescript">interface CharacterCard {
  spec: &#39;chara_card_v3&#39;
  spec_version: &#39;3.0&#39;
  data: CharacterData
}
</code></pre>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>spec</code></td>
<td><code>&#39;chara_card_v3&#39;</code></td>
<td>Format identifier (always this value)</td>
</tr>
<tr>
<td><code>spec_version</code></td>
<td><code>&#39;3.0&#39;</code></td>
<td>Version string (always this value)</td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>CharacterData</code></td>
<td>The character data</td>
</tr>
</tbody></table>
<hr>
<h2>CharacterData</h2>
<p>Character information and metadata.</p>
<pre><code class="language-typescript">interface CharacterData {
  // V1 base fields (required)
  name: string
  description: string
  personality: string
  scenario: string
  first_mes: string
  mes_example: string

  // V2 additions
  creator_notes: string
  system_prompt: string
  post_history_instructions: string
  alternate_greetings: string[]
  tags: string[]
  creator: string
  character_version: string
  extensions: Record&lt;string, unknown&gt;

  // V3 additions
  nickname?: string
  creator_notes_multilingual?: Record&lt;string, string&gt;
  source?: string[]
  group_only_greetings: string[]
  creation_date?: number
  modification_date?: number
  assets?: Asset[]
  character_book?: Lorebook
}
</code></pre>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Character&#39;s name</td>
</tr>
<tr>
<td><code>description</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Character description/background</td>
</tr>
<tr>
<td><code>personality</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Personality traits</td>
</tr>
<tr>
<td><code>scenario</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>The situation/context</td>
</tr>
<tr>
<td><code>first_mes</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Opening message</td>
</tr>
<tr>
<td><code>mes_example</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Example dialogue format</td>
</tr>
<tr>
<td><code>creator_notes</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Notes from the creator</td>
</tr>
<tr>
<td><code>system_prompt</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>System prompt override</td>
</tr>
<tr>
<td><code>post_history_instructions</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Instructions after history</td>
</tr>
<tr>
<td><code>alternate_greetings</code></td>
<td><code>string[]</code></td>
<td>Yes</td>
<td>Alternative opening messages</td>
</tr>
<tr>
<td><code>tags</code></td>
<td><code>string[]</code></td>
<td>Yes</td>
<td>Categorization tags</td>
</tr>
<tr>
<td><code>creator</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Creator name/identifier</td>
</tr>
<tr>
<td><code>character_version</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Version string</td>
</tr>
<tr>
<td><code>extensions</code></td>
<td><code>Record&lt;string, unknown&gt;</code></td>
<td>Yes</td>
<td>App-specific data</td>
</tr>
<tr>
<td><code>nickname</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Display name override</td>
</tr>
<tr>
<td><code>creator_notes_multilingual</code></td>
<td><code>Record&lt;string, string&gt;</code></td>
<td>No</td>
<td>Localized creator notes</td>
</tr>
<tr>
<td><code>source</code></td>
<td><code>string[]</code></td>
<td>No</td>
<td>Source URLs</td>
</tr>
<tr>
<td><code>group_only_greetings</code></td>
<td><code>string[]</code></td>
<td>Yes</td>
<td>Greetings for group chats</td>
</tr>
<tr>
<td><code>creation_date</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Unix timestamp</td>
</tr>
<tr>
<td><code>modification_date</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Unix timestamp</td>
</tr>
<tr>
<td><code>assets</code></td>
<td><code>Asset[]</code></td>
<td>No</td>
<td>Bundled assets</td>
</tr>
<tr>
<td><code>character_book</code></td>
<td><code>Lorebook</code></td>
<td>No</td>
<td>Embedded lorebook</td>
</tr>
</tbody></table>
<hr>
<h2>Asset</h2>
<p>Asset metadata for images bundled with the card.</p>
<pre><code class="language-typescript">interface Asset {
  type: string
  uri: string
  name: string
  ext: string
}
</code></pre>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Asset type: <code>&#39;icon&#39;</code>, <code>&#39;background&#39;</code>, <code>&#39;emotion&#39;</code>, <code>&#39;user_icon&#39;</code>, etc.</td>
</tr>
<tr>
<td><code>uri</code></td>
<td><code>string</code></td>
<td>Location: URL, data URI, <code>&#39;ccdefault:&#39;</code>, or <code>&#39;embeded://path&#39;</code></td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Asset identifier: <code>&#39;main&#39;</code>, <code>&#39;happy&#39;</code>, <code>&#39;sad&#39;</code>, etc.</td>
</tr>
<tr>
<td><code>ext</code></td>
<td><code>string</code></td>
<td>File extension: <code>&#39;png&#39;</code>, <code>&#39;jpg&#39;</code>, <code>&#39;webp&#39;</code>, etc.</td>
</tr>
</tbody></table>
<hr>
<h2>Lorebook</h2>
<p>Knowledge database structure.</p>
<pre><code class="language-typescript">interface Lorebook {
  name?: string
  description?: string
  scan_depth?: number
  token_budget?: number
  recursive_scanning?: boolean
  extensions: Record&lt;string, unknown&gt;
  entries: LorebookEntry[]
}
</code></pre>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Lorebook name</td>
</tr>
<tr>
<td><code>description</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Lorebook description</td>
</tr>
<tr>
<td><code>scan_depth</code></td>
<td><code>number</code></td>
<td>No</td>
<td>How far back to scan for triggers</td>
</tr>
<tr>
<td><code>token_budget</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Maximum tokens to use</td>
</tr>
<tr>
<td><code>recursive_scanning</code></td>
<td><code>boolean</code></td>
<td>No</td>
<td>Scan activated entries for more triggers</td>
</tr>
<tr>
<td><code>extensions</code></td>
<td><code>Record&lt;string, unknown&gt;</code></td>
<td>Yes</td>
<td>App-specific data</td>
</tr>
<tr>
<td><code>entries</code></td>
<td><code>LorebookEntry[]</code></td>
<td>Yes</td>
<td>Lorebook entries</td>
</tr>
</tbody></table>
<hr>
<h2>StandaloneLorebook</h2>
<p>Wrapper for standalone lorebook files.</p>
<pre><code class="language-typescript">interface StandaloneLorebook {
  spec: &#39;lorebook_v3&#39;
  data: Lorebook
}
</code></pre>
<hr>
<h2>LorebookEntry</h2>
<p>Individual lorebook entry.</p>
<pre><code class="language-typescript">interface LorebookEntry {
  // Required fields
  keys: string[]
  content: string
  enabled: boolean
  insertion_order: number
  use_regex: boolean
  extensions: Record&lt;string, unknown&gt;

  // Optional fields
  id?: string | number
  name?: string
  comment?: string
  priority?: number
  case_sensitive?: boolean
  selective?: boolean
  secondary_keys?: string[]
  constant?: boolean
  position?: string

  // V3 parsed decorators
  decorators?: Decorator[]
}
</code></pre>
<table>
<thead>
<tr>
<th>Property</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>keys</code></td>
<td><code>string[]</code></td>
<td>Yes</td>
<td>Trigger keywords</td>
</tr>
<tr>
<td><code>content</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Content to inject</td>
</tr>
<tr>
<td><code>enabled</code></td>
<td><code>boolean</code></td>
<td>Yes</td>
<td>Whether entry is active</td>
</tr>
<tr>
<td><code>insertion_order</code></td>
<td><code>number</code></td>
<td>Yes</td>
<td>Priority (lower = first)</td>
</tr>
<tr>
<td><code>use_regex</code></td>
<td><code>boolean</code></td>
<td>Yes</td>
<td>Keys are regex patterns</td>
</tr>
<tr>
<td><code>extensions</code></td>
<td><code>Record&lt;string, unknown&gt;</code></td>
<td>Yes</td>
<td>App-specific data</td>
</tr>
<tr>
<td><code>id</code></td>
<td><code>string | number</code></td>
<td>No</td>
<td>Entry identifier</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Entry name</td>
</tr>
<tr>
<td><code>comment</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Internal comment</td>
</tr>
<tr>
<td><code>priority</code></td>
<td><code>number</code></td>
<td>No</td>
<td>Activation priority</td>
</tr>
<tr>
<td><code>case_sensitive</code></td>
<td><code>boolean</code></td>
<td>No</td>
<td>Case-sensitive matching</td>
</tr>
<tr>
<td><code>selective</code></td>
<td><code>boolean</code></td>
<td>No</td>
<td>Require secondary keys</td>
</tr>
<tr>
<td><code>secondary_keys</code></td>
<td><code>string[]</code></td>
<td>No</td>
<td>Additional required keys</td>
</tr>
<tr>
<td><code>constant</code></td>
<td><code>boolean</code></td>
<td>No</td>
<td>Always active</td>
</tr>
<tr>
<td><code>position</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Insertion position</td>
</tr>
<tr>
<td><code>decorators</code></td>
<td><code>Decorator[]</code></td>
<td>No</td>
<td>Parsed V3 decorators</td>
</tr>
</tbody></table>
<hr>
<h2>Decorator</h2>
<p>See <a href="api-decorator.html">Decorator API</a> for the full type definition.</p>
<hr>
<h2>Legacy Types</h2>
<h3>CharacterCardV2</h3>
<pre><code class="language-typescript">interface CharacterCardV2 {
  spec: &#39;chara_card_v2&#39;
  spec_version: &#39;2.0&#39;
  data: CharacterDataV2
}
</code></pre>
<h3>CharacterCardV1</h3>
<pre><code class="language-typescript">type CharacterCardV1 = CharacterDataV1

interface CharacterDataV1 {
  name: string
  description: string
  personality: string
  scenario: string
  first_mes: string
  mes_example: string
}
</code></pre>
<p>These are used internally for parsing. The library normalizes all cards to V3.</p>
<hr>
<h2>PNG Types</h2>
<h3>PngChunk</h3>
<pre><code class="language-typescript">interface PngChunk {
  length: number
  type: string
  data: Uint8Array
  crc: number
}
</code></pre>
<h3>ExtractedCardData</h3>
<pre><code class="language-typescript">interface ExtractedCardData {
  json: CharacterCard | CharacterCardV2 | CharacterCardV1
  keyword: string
  chunkIndex: number
}
</code></pre>

        </article>
      </main>
    </div>
  </div>
</body>
</html>
